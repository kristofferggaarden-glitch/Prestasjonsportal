<Window x:Class="ABBsPrestasjonsportal.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="ABBs Prestasjonsportal" Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">

    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#F5F5F5" Offset="0"/>
            <GradientStop Color="#E0E0E0" Offset="1"/>
        </LinearGradientBrush>
    </Window.Background>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="{StaticResource ABBRed}" Offset="0"/>
                    <GradientStop Color="{StaticResource ABBPurple}" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                    <TextBlock Text="âš¡" FontSize="36" Foreground="White" Margin="0,0,10,0"/>
                    <TextBlock Text="ABBs Prestasjonsportal" Style="{StaticResource HeaderText}" VerticalAlignment="Center"/>
                </StackPanel>

                <TextBlock Grid.Column="2" x:Name="DateTimeText" 
                          Foreground="White" VerticalAlignment="Center" 
                          Margin="20,0" FontSize="14"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Side Navigation -->
            <Border Grid.Column="0" Background="White" Margin="0,0,1,0">
                <Border.Effect>
                    <DropShadowEffect Color="Gray" Direction="0" ShadowDepth="1" Opacity="0.2" BlurRadius="5"/>
                </Border.Effect>

                <StackPanel Margin="10">
                    <Button x:Name="BtnTopList" Content="ðŸ† Toppliste" 
                            Style="{StaticResource ModernButton}" 
                            Background="{StaticResource ABBRedBrush}"
                            Margin="0,5" Click="BtnTopList_Click"/>

                    <Button x:Name="BtnEmployees" Content="ðŸ‘¥ Ansatte" 
                            Style="{StaticResource ModernButton}"
                            Background="{StaticResource ABBBlueBrush}"
                            Margin="0,5" Click="BtnEmployees_Click"/>

                    <Button x:Name="BtnExercises" Content="ðŸ’ª Ã˜velser" 
                            Style="{StaticResource ModernButton}"
                            Background="{StaticResource ABBPurpleBrush}"
                            Margin="0,5" Click="BtnExercises_Click"/>

                    <Button x:Name="BtnResults" Content="ðŸ“Š Resultater" 
                            Style="{StaticResource ModernButton}"
                            Background="{StaticResource ABBGreenBrush}"
                            Margin="0,5" Click="BtnResults_Click"/>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="Statistikk" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBlock x:Name="TotalEmployeesText" Text="Ansatte: 0" Margin="0,2"/>
                    <TextBlock x:Name="TotalExercisesText" Text="Ã˜velser: 0" Margin="0,2"/>
                    <TextBlock x:Name="TotalResultsText" Text="Resultater: 0" Margin="0,2"/>

                    <Separator Margin="0,20"/>

                    <TextBlock Text="ðŸ”„ Synk-status" FontWeight="Bold" Margin="0,10,0,5"/>
                    <TextBlock x:Name="SyncStatusText" Text="âœ… Tilkoblet" Foreground="Green" Margin="0,2"/>
                </StackPanel>
            </Border>

            <!-- Content Area -->
            <Grid Grid.Column="1" Margin="20">
                <!-- Top List View -->
                <Grid x:Name="TopListView" Visibility="Visible">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="200"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="ðŸ† Toppliste - Totale Prestasjoner" 
                              Style="{StaticResource SubHeaderText}" Margin="0,0,0,20"/>

                    <!-- Podium -->
                    <Grid Grid.Row="1" HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="150"/>
                        </Grid.ColumnDefinitions>

                        <!-- Silver (2nd place) -->
                        <Border Grid.Column="0" Style="{StaticResource Card}" 
                                Height="140" VerticalAlignment="Bottom" Margin="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#E0E0E0" Offset="0"/>
                                    <GradientStop Color="{StaticResource Silver}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="ðŸ¥ˆ" FontSize="48" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="Silver_Name" Text="-" HorizontalAlignment="Center" FontWeight="Bold"/>
                                <TextBlock x:Name="Silver_Points" Text="0 poeng" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Gold (1st place) -->
                        <Border Grid.Column="1" Style="{StaticResource Card}" 
                                Height="160" VerticalAlignment="Bottom" Margin="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#FFF8DC" Offset="0"/>
                                    <GradientStop Color="{StaticResource Gold}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="ðŸ¥‡" FontSize="56" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="Gold_Name" Text="-" HorizontalAlignment="Center" FontWeight="Bold" FontSize="16"/>
                                <TextBlock x:Name="Gold_Points" Text="0 poeng" HorizontalAlignment="Center" FontSize="14"/>
                            </StackPanel>
                        </Border>

                        <!-- Bronze (3rd place) -->
                        <Border Grid.Column="2" Style="{StaticResource Card}" 
                                Height="120" VerticalAlignment="Bottom" Margin="5">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#F4E4C1" Offset="0"/>
                                    <GradientStop Color="{StaticResource Bronze}" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="ðŸ¥‰" FontSize="40" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="Bronze_Name" Text="-" HorizontalAlignment="Center" FontWeight="Bold"/>
                                <TextBlock x:Name="Bronze_Points" Text="0 poeng" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Full Ranking List -->
                    <Border Grid.Row="2" Style="{StaticResource Card}" Margin="0,20,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="Full Rangering" FontWeight="Bold" Margin="0,0,0,10"/>

                            <DataGrid Grid.Row="1" x:Name="TopListGrid" 
                                     AutoGenerateColumns="False" 
                                     CanUserAddRows="False"
                                     GridLinesVisibility="None"
                                     HeadersVisibility="Column">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Rang" Binding="{Binding Rank}" Width="60"/>
                                    <DataGridTextColumn Header="Navn" Binding="{Binding Name}" Width="200"/>
                                    <DataGridTextColumn Header="Avdeling" Binding="{Binding Department}" Width="150"/>
                                    <DataGridTextColumn Header="Antall Ã˜velser" Binding="{Binding ExerciseCount}" Width="100"/>
                                    <DataGridTextColumn Header="Total Poeng" Binding="{Binding TotalPoints}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Employees View -->
                <Grid x:Name="EmployeesView" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="ðŸ‘¥ Ansatte" Style="{StaticResource SubHeaderText}" Margin="0,0,0,20"/>

                    <Border Grid.Row="1" Style="{StaticResource Card}" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Legg til ny ansatt" FontWeight="Bold" Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Navn" Margin="0,0,5,5" FontWeight="SemiBold"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="Avdeling" Margin="0,0,5,5" FontWeight="SemiBold"/>

                                <TextBox x:Name="NewEmployeeName" Grid.Row="1" Grid.Column="0" 
                                        Margin="0,0,5,0" Padding="5" KeyDown="NewEmployeeName_KeyDown"/>
                                <ComboBox x:Name="DepartmentCombo" Grid.Row="1" Grid.Column="1" 
                                         Margin="0,0,5,0" Padding="5" KeyDown="DepartmentCombo_KeyDown">
                                    <ComboBoxItem>IT</ComboBoxItem>
                                    <ComboBoxItem>Salg</ComboBoxItem>
                                    <ComboBoxItem>Produksjon</ComboBoxItem>
                                    <ComboBoxItem>HR</ComboBoxItem>
                                    <ComboBoxItem>Ã˜konomi</ComboBoxItem>
                                </ComboBox>
                                <Button Grid.Row="1" Grid.Column="2" Content="âž• Legg til" 
                                       Style="{StaticResource ModernButton}"
                                       Click="AddEmployee_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="2" Style="{StaticResource Card}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="200"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="Ansattliste" FontWeight="Bold" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1" x:Name="SearchBox" Tag="ðŸ” SÃ¸k..." 
                                        Padding="5" TextChanged="SearchBox_TextChanged"/>
                            </Grid>

                            <DataGrid Grid.Row="1" x:Name="EmployeesGrid" 
                                     AutoGenerateColumns="False" 
                                     CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                    <DataGridTextColumn Header="Navn" Binding="{Binding Name}" Width="300"/>
                                    <DataGridTextColumn Header="Avdeling" Binding="{Binding Department}" Width="200"/>
                                    <DataGridTemplateColumn Header="Handlinger" Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="ðŸ—‘ï¸ Slett" Click="DeleteEmployee_Click" 
                                                       Tag="{Binding}" Padding="5,2"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Exercises View -->
                <Grid x:Name="ExercisesView" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="ðŸ’ª Ã˜velser" Style="{StaticResource SubHeaderText}" Margin="0,0,0,20"/>

                    <Border Grid.Row="1" Style="{StaticResource Card}" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Legg til ny Ã¸velse" FontWeight="Bold" Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="250"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="NewExerciseName" Grid.Column="0" 
                                        Tag="Ã˜velsesnavn" Margin="0,0,5,0" Padding="5"/>
                                <ComboBox x:Name="ExerciseTypeCombo" Grid.Column="1" 
                                         Margin="0,0,5,0" Padding="5">
                                    <ComboBoxItem>LÃ¸ping</ComboBoxItem>
                                    <ComboBoxItem>Styrke</ComboBoxItem>
                                    <ComboBoxItem>Kondisjon</ComboBoxItem>
                                    <ComboBoxItem>Annet</ComboBoxItem>
                                </ComboBox>
                                <ComboBox x:Name="ExerciseUnitCombo" Grid.Column="2" 
                                         Margin="0,0,5,0" Padding="5">
                                    <ComboBoxItem>Tid (TT:MM:SS)</ComboBoxItem>
                                    <ComboBoxItem>Vekt (kg)</ComboBoxItem>
                                    <ComboBoxItem>Repetisjoner</ComboBoxItem>
                                    <ComboBoxItem>Distanse (m)</ComboBoxItem>
                                </ComboBox>
                                <Button Grid.Column="3" Content="âž• Legg til" 
                                       Style="{StaticResource ModernButton}"
                                       Click="AddExercise_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="2" Style="{StaticResource Card}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="Ã˜velsesliste" FontWeight="Bold" Margin="0,0,0,10"/>

                            <DataGrid Grid.Row="1" x:Name="ExercisesGrid" 
                                     AutoGenerateColumns="False" 
                                     CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                    <DataGridTextColumn Header="Navn" Binding="{Binding Name}" Width="250"/>
                                    <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="150"/>
                                    <DataGridTextColumn Header="Enhet" Binding="{Binding Unit}" Width="150"/>
                                    <DataGridTemplateColumn Header="Handlinger" Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="ðŸ—‘ï¸ Slett" Click="DeleteExercise_Click" 
                                                       Tag="{Binding}" Padding="5,2"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Results View -->
                <Grid x:Name="ResultsView" Visibility="Collapsed">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="ðŸ“Š Resultater" Style="{StaticResource SubHeaderText}" Margin="0,0,0,20"/>

                    <Border Grid.Row="1" Style="{StaticResource Card}" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Registrer nytt resultat" FontWeight="Bold" Margin="0,0,0,10"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <ComboBox x:Name="ResultEmployeeCombo" Grid.Column="0" 
                                         Margin="0,0,5,0" Padding="5"/>
                                <ComboBox x:Name="ResultExerciseCombo" Grid.Column="1" 
                                         Margin="0,0,5,0" Padding="5"/>
                                <TextBox x:Name="ResultValue" Grid.Column="2" 
                                        Tag="Resultat" Margin="0,0,5,0" Padding="5"/>
                                <Button Grid.Column="3" Content="âž• Registrer" 
                                       Style="{StaticResource ModernButton}"
                                       Click="AddResult_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="2" Style="{StaticResource Card}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="Resultatliste" FontWeight="Bold" Margin="0,0,0,10"/>

                            <DataGrid Grid.Row="1" x:Name="ResultsGrid" 
                                     AutoGenerateColumns="False" 
                                     CanUserAddRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Dato" Binding="{Binding Date, StringFormat='{}{0:dd.MM.yyyy}'}" Width="100"/>
                                    <DataGridTextColumn Header="Ansatt" Binding="{Binding EmployeeName}" Width="200"/>
                                    <DataGridTextColumn Header="Ã˜velse" Binding="{Binding ExerciseName}" Width="200"/>
                                    <DataGridTextColumn Header="Resultat" Binding="{Binding Value}" Width="100"/>
                                    <DataGridTextColumn Header="Poeng" Binding="{Binding Points}" Width="80">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Foreground" Value="{StaticResource ABBGreenBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>